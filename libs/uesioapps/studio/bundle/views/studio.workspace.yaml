name: workspace
definition:
  # Wires are how we pull in data
  wires:
    workspaces:
      collection: studio.workspaces
      fields:
        studio.id:
        studio.name:
        studio.appid:
        studio.app:
          fields:
            uesio.color:
        studio.homeroute:
        studio.loginroute:
        studio.defaultprofile:
        studio.publicprofile:
      conditions:
        - field: studio.appid
          valueSource: PARAM
          param: appname
        - field: studio.name
          valueSource: PARAM
          param: workspacename
    installedapps:
      collection: studio.bundledependencies
      fields:
        studio.id:
        studio.bundle:
          fields:
            uesio.namespace:
            uesio.major:
            uesio.minor:
            uesio.patch:
      conditions:
        - field: studio.workspaceid
          value: $Param{appname}_$Param{workspacename}
  # Components are how we describe the layout of our view
  components:
    - io.grid:
        uesio.styles:
          root:
            minHeight: 100vh
        templateRows: 60px 1fr
        items:
          - uesio.view:
              view: studio.topbar
              uesio.context:
                wire: workspaces
          - io.grid:
              uesio.styles:
                root:
                  gridRow: 2
              templateColumns: 300px 1fr
              items:
                - io.griditem:
                    uesio.styles:
                      root:
                        backgroundColor: "#fafafa"
                    components:
                      - uesio.view:
                          uesio.context:
                            wire: workspaces
                          view: studio.workspacenav
                - io.griditem:
                    components:
                      - material.deck:
                          xs: 12
                          margin: 0
                          id: workspaceDeck
                          wire: workspaces
                          mode: READ
                          components:
                            - material.grid:
                                items:
                                  - material.griditem:
                                      xs: true
                                      components:
                                        - material.card:
                                            media:
                                              background:
                                                color:
                                                  intention: "primary"
                                              height: 10px
                                            margin: 1
                                            components:
                                              - material.grid:
                                                  justify: space-between
                                                  alignitems: center
                                                  items:
                                                    - material.griditem:
                                                        components:
                                                          - material.typography:
                                                              text: ${studio.name}
                                                              variant: h5
                                                              textTransform: "uppercase"
                                                    - material.griditem:
                                                        components:
                                                          - material.buttonset:
                                                              buttons:
                                                                - material.button:
                                                                    color: "primary"
                                                                    variant: "outlined"
                                                                    text: "Edit"
                                                                    signals:
                                                                      - signal: component/material.deck/TOGGLE_MODE
                                                                        target: "workspaceDeck"
                                                                - material.button:
                                                                    color: "primary"
                                                                    variant: "outlined"
                                                                    text: "Save"
                                                                    signals:
                                                                      - signal: wire/SAVE
                                                                        wires:
                                                                          - "workspaces"
                                                                - material.button:
                                                                    color: "primary"
                                                                    variant: "outlined"
                                                                    text: "Cancel"
                                                                    signals:
                                                                      - signal: wire/CANCEL
                                                                        wire: "workspaces"
                                                                - material.button:
                                                                    color: "primary"
                                                                    variant: "outlined"
                                                                    text: "Delete"
                                                                    signals:
                                                                      - signal: wire/MARK_FOR_DELETE
                                                                      - signal: wire/SAVE
                                                                        wires:
                                                                          - "workspaces"
                                                                      - signal: "route/NAVIGATE"
                                                                        path: "app/$Param{appname}"
                                              - material.field:
                                                  fieldId: studio.name
                                              - studio.metadatafield:
                                                  fieldId: studio.homeroute
                                                  metadataType: "ROUTE"
                                                  label: "Home Route"
                                              - studio.metadatafield:
                                                  fieldId: studio.loginroute
                                                  metadataType: "ROUTE"
                                                  label: "Login Route"
                                              - studio.metadatafield:
                                                  fieldId: studio.defaultprofile
                                                  metadataType: "PROFILE"
                                                  label: "Default Profile"
                                              - studio.metadatafield:
                                                  fieldId: studio.publicprofile
                                                  metadataType: "PROFILE"
                                                  label: "Public Profile"
                                        - material.card:
                                            components:
                                              - material.buttonset:
                                                  buttons:
                                                    - material.button:
                                                        color: "primary"
                                                        variant: "outlined"
                                                        text: "Import Data"
                                                        signals:
                                                          - signal: "route/NAVIGATE"
                                                            path: "app/$Param{appname}/workspace/$Param{workspacename}/import"
                                                    - material.button:
                                                        color: "primary"
                                                        variant: "outlined"
                                                        text: "Configuration"
                                                        signals:
                                                          - signal: "route/NAVIGATE"
                                                            path: "app/$Param{appname}/workspace/$Param{workspacename}/configuration"
                                                    - material.button:
                                                        color: "primary"
                                                        variant: "outlined"
                                                        text: "Create New Bundle Version"
                                                        signals:
                                                          - signal: "bot/CALL"
                                                            bot: "studio.newbundle"
                                                            params:
                                                              workspace: $Param{workspacename}
                                                              app: $Param{appname}
                                                          - signal: "route/NAVIGATE"
                                                            path: "app/$Param{appname}"
                                        - material.grid:
                                            justify: space-between
                                            alignitems: center
                                            items:
                                              - material.griditem:
                                                  components:
                                                    - material.typography:
                                                        text: Installed Bundles
                                                        variant: h5
                                              - material.griditem:
                                                  components:
                                                    - material.buttonset:
                                                        buttons:
                                                          - material.button:
                                                              color: "primary"
                                                              variant: "outlined"
                                                              text: "Browse Bundle Store"
                                                              signals:
                                                                - signal: "route/NAVIGATE"
                                                                  path: "app/$Param{appname}/workspace/$Param{workspacename}/add-bundle"
                                        - material.deck:
                                            xs: 3
                                            margin: 0
                                            id: installedDeck
                                            wire: installedapps
                                            mode: READ
                                            components:
                                              - material.card:
                                                  media:
                                                    background:
                                                      color:
                                                        intention: "primary"
                                                    height: 10px
                                                  margin: 1
                                                  components:
                                                    - material.typography:
                                                        text: ${["studio.bundle"]["uesio.namespace"]}
                                                    - material.typography:
                                                        text: v${["studio.bundle"]["uesio.major"]}.${["studio.bundle"]["uesio.minor"]}.${["studio.bundle"]["uesio.patch"]}
                                                  signals:
                                                    - signal: "route/NAVIGATE"
                                                      path: "app/$Param{appname}/workspace/$Param{workspacename}/installed/${studio.id}"
