name: opportunities
public: true
definition:
  components:
    - uesio/core.view:
        view: uesio/crm.topbar
    - uesio/io.box:
        uesio.variant: uesio/crm.content
        components:
          - uesio/io.titlebar:
              title: Opportunities
              uesio.variant: uesio/io.main
              actions:
                - uesio/io.group:
                    components:
                      - uesio/io.button:
                          signals:
                            - signal: wire/CREATE_RECORD
                              wire: opportunities
                              prepend: true
                          text: Create
                          uesio.variant: uesio/io.secondary
                      - uesio/io.button:
                          signals:
                            - signal: wire/SAVE
                              wires:
                                - opportunities
                          text: $Label{uesio/io.save}
                          uesio.variant: uesio/io.secondary
                      - uesio/io.button:
                          signals:
                            - signal: wire/CANCEL
                              wire: opportunities
                          text: $Label{uesio/io.cancel}
                          uesio.variant: uesio/io.secondary
                      - uesio/io.button:
                          signals:
                            - signal: component/CALL
                              component: uesio/io.table
                              componentsignal: TOGGLE_MODE
                              targettype: specific
                              componentid: opportunitiesTable
                          text: Mode
                          uesio.variant: uesio/io.secondary
          - uesio/io.grid:
              uesio.styleTokens:
                root:
                  - grid-cols-2
                  - gap-x-6
                  - pb-10
              items:
                - uesio/io.linechart:
                    uesio.styleTokens:
                      chart:
                        - h-[300px]
                    series:
                      - name: revenue
                        label: Expected Revenue
                        valueField: uesio/crm.expected_revenue
                        categoryField: uesio/crm.close_date
                        wire: opportunities
                      - name: amount
                        label: Opportunity Amount
                        valueField: uesio/crm.amount
                        categoryField: uesio/crm.close_date
                        wire: opportunities
                    labels:
                      source: DATA
                      timeunit: MONTH
                - uesio/io.barchart:
                    uesio.styleTokens:
                      chart:
                        - h-[300px]
                    series:
                      - name: revenue
                        label: Expected Revenue
                        valueField: uesio/crm.expected_revenue
                        categoryField: uesio/crm.close_date
                        wire: opportunities
                      - name: amount
                        label: Opportunity Amount
                        valueField: uesio/crm.amount
                        categoryField: uesio/crm.close_date
                        wire: opportunities
                    labels:
                      source: DATA
                      timeunit: MONTH
          - uesio/io.table:
              rowactions:
                - text: $Label{uesio/io.edit}
                  signals:
                    - path: opportunity/${uesio/core.id}
                      signal: route/NAVIGATE
                - text: $Label{uesio/io.delete}
                  signals:
                    - signal: wire/TOGGLE_DELETE_STATUS
              columns:
                - field: uesio/crm.name
                - field: uesio/crm.status
                - field: uesio/crm.account
                - field: uesio/crm.close_date
                - field: uesio/crm.expected_revenue
                - field: uesio/crm.amount
              uesio.id: opportunitiesTable
              mode: EDIT
              wire: opportunities
  wires:
    opportunities:
      collection: uesio/crm.opportunity
      fields:
        uesio/crm.name:
        uesio/core.id:
        uesio/crm.status:
        uesio/crm.description:
        uesio/crm.account:
          fields:
            uesio/crm.name:
        uesio/core.updatedat:
        uesio/core.createdat:
        uesio/crm.close_date:
        uesio/crm.expected_revenue:
        uesio/crm.amount:
