name: contacts
public: true
definition:
  # Wires connect to data in collections
  wires:
    contacts:
      collection: uesio/crm.contact
      fields:
        uesio/crm.firstname: null
        uesio/crm.externalid: null
        uesio/crm.lastname: null
        uesio/crm.image: null
        uesio/crm.title: null
        uesio/crm.department: null
        uesio/crm.email: null
        uesio/crm.phone_business: null
        uesio/crm.phone_mobile: null
        uesio/crm.assistant_name: null
        uesio/crm.assistant_phone: null
        uesio/crm.email_opt_out: null
        uesio/crm.mailing_city: null
        uesio/crm.reports_to: null
        uesio/crm.salutation: null
        uesio/core.createdat: null
        uesio/core.createdby: null
        uesio/core.id: null
        uesio/core.owner: null
        uesio/core.updatedat: null
        uesio/core.updatedby: null
        uesio/crm.account:
          fields:
            uesio/crm.name: null
      order:
        - desc: false
          field: uesio/crm.firstname
      batchsize: null
    newcontact:
      collection: uesio/crm.contact
      fields:
        uesio/crm.firstname: null
        uesio/crm.lastname: null
        uesio/crm.email: null
        uesio/crm.phone_business: null
        uesio/crm.phone_mobile: null
        uesio/crm.image: null
        uesio/core.id: null
        uesio/crm.assistant_name: null
        uesio/crm.birthdate: null
        uesio/crm.department: null
        uesio/crm.description: null
        uesio/crm.email_opt_out: null
        uesio/crm.externalid: null
        uesio/crm.gender: null
        uesio/crm.lead_source: null
        uesio/crm.mailing_city: null
        uesio/crm.mailing_country: null
        uesio/crm.mailing_state: null
        uesio/crm.mailing_street: null
        uesio/crm.mailing_zip: null
        uesio/crm.reports_to: null
        uesio/crm.salutation: null
        uesio/crm.title: null
        uesio/crm.account:
          fields:
            uesio/crm.name: null
            uesio/core.id: null
        uesio/crm.assistant_phone: null
        uesio/core.owner:
          fields:
            uesio/core.id: null
            uesio/core.username: null
      batchsize: 1
      conditions:
        - operator: EQ
          field: uesio/core.id
          valueSource: VALUE
          id: id
    contactsmod:
      collection: uesio/crm.contact
      fields:
        uesio/crm.account: null
        uesio/crm.firstname: null
        uesio/crm.externalid: null
        uesio/crm.lastname: null
        uesio/crm.image: null
        uesio/crm.title: null
        uesio/crm.department: null
        uesio/crm.email: null
        uesio/crm.phone_business: null
        uesio/crm.phone_mobile: null
        uesio/core.updatedat: null
      order:
        - desc: true
          field: uesio/core.updatedat
  # Components determine the layout and composition of your view
  components:
    - uesio/core.view:
        view: uesio/crm.topbar
    - uesio/io.box:
        uesio.variant: uesio/crm.content
        components:
          - uesio/io.titlebar:
              title: Contacts
              uesio.variant: uesio/io.main
              actions:
                - uesio/io.button:
                    text: New Contact
                    uesio.variant: uesio/io.primary
                    signals:
                      - signal: wire/EMPTY
                        wire: newcontact
                      - signal: panel/OPEN
                        panel: newContact
                      - signal: wire/CREATE_RECORD
                        wire: newcontact
                        prepend: true
                    icon: create
          - uesio/io.deck:
              wire: contacts
              uesio.styleTokens:
                root:
                  - grid-cols-1
                  - lg:grid-cols-2
                  - xl:grid-cols-3
                  - 2xl:grid-cols-4
                  - grid
                  - gap-8
              components:
                - uesio/io.box:
                    uesio.styleTokens:
                      root:
                        - shadow
                        - bg-white
                        - overflow-hidden
                        - rounded-lg
                        - grid
                        - grid-cols-3
                    components:
                      - uesio/io.avatar:
                          uesio.variant: uesio/crm.cardimage
                          image: $UserFile{uesio/crm.image}
                      - uesio/io.box:
                          uesio.styleTokens:
                            root:
                              - col-span-2
                              - p-8
                          components:
                            - uesio/io.titlebar:
                                variant: uesio/io.infotag
                                title: ${uesio/crm.firstname} ${uesio/crm.lastname}
                                subtitle: ${uesio/crm.account->uesio/crm.name}
                                actions:
                                  - uesio/io.text:
                                      text: ${uesio/crm.externalid}
                                      uesio.variant: uesio/io.aside
                            - uesio/io.grid:
                                items:
                                  - uesio/io.box:
                                      uesio.styleTokens:
                                        root:
                                          - my-4
                                      components:
                                        - uesio/io.field:
                                            fieldId: uesio/crm.email
                                        - uesio/io.grid:
                                            uesio.styleTokens:
                                              root:
                                                - grid-cols-2
                                                - gap-4
                                            items:
                                              - uesio/io.field:
                                                  fieldId: uesio/crm.phone_business
                                              - uesio/io.field:
                                                  fieldId: uesio/crm.phone_mobile
                                  - uesio/io.group:
                                      components:
                                        - uesio/io.button:
                                            icon: delete
                                            signals:
                                              - signal: wire/SET_CONDITION_VALUE
                                                wire: newcontact
                                                conditionId: id
                                                value: ${uesio/core.id}
                                              - signal: wire/LOAD
                                                wires:
                                                  - newcontact
                                              - signal: panel/OPEN
                                                wires:
                                                  - contacts
                                                panel: delete
                                        - uesio/io.button:
                                            icon: email
                                        - uesio/io.button:
                                            icon: edit
                                            signals:
                                              - signal: wire/SET_CONDITION_VALUE
                                                wire: newcontact
                                                conditionId: id
                                                value: ${uesio/core.id}
                                              - signal: wire/LOAD
                                                wires:
                                                  - newcontact
                                              - signal: panel/OPEN
                                                panel: newContact
              id: contactDeck
              mode: READ
  panels:
    newContact:
      uesio.type: uesio/io.dialog
      components:
        - uesio/io.tabs:
            tabs:
              - id: basic
                label: Basic Info
                components:
                  - uesio/io.deck:
                      wire: newcontact
                      mode: EDIT
                      components:
                        - uesio/io.grid:
                            uesio.styleTokens:
                              root:
                                - grid-cols-2
                                - grid-rows-3
                            items:
                              - uesio/io.field:
                                  fieldId: uesio/crm.externalid
                              - uesio/io.field:
                                  fieldId: uesio/crm.firstname
                              - uesio/io.field:
                                  fieldId: uesio/crm.lastname
                              - uesio/io.field:
                                  fieldId: uesio/crm.phone_mobile
                              - uesio/io.field:
                                  fieldId: uesio/crm.phone_business
                              - uesio/io.field:
                                  fieldId: uesio/crm.home_phone
                              - uesio/io.field:
                                  fieldId: uesio/crm.email
                              - uesio/io.field:
                                  fieldId: uesio/crm.birthdate
                              - uesio/io.field:
                                  fieldId: uesio/crm.email_opt_out
                              - uesio/io.field:
                                  fieldId: uesio/crm.gender
                              - uesio/io.field:
                                  fieldId: uesio/crm.salutation
                              - uesio/io.field:
                                  fieldId: uesio/core.user
                            columnGap: 8px
              - id: address
                label: Address
                components:
                  - uesio/io.deck:
                      wire: newcontact
                      mode: EDIT
                      components:
                        - uesio/io.grid:
                            uesio.styleTokens:
                              root:
                                - grid-cols-2
                                - grid-rows-3
                            items:
                              - uesio/io.field:
                                  fieldId: uesio/crm.mailing_street
                              - uesio/io.field:
                                  fieldId: uesio/crm.mailing_city
                              - uesio/io.field:
                                  fieldId: uesio/crm.mailing_country
                              - uesio/io.field:
                                  fieldId: uesio/crm.mailing_state
                              - uesio/io.field:
                                  fieldId: uesio/crm.mailing_zip
                            columnGap: 8px
              - id: company
                label: Company
                components:
                  - uesio/io.deck:
                      wire: newcontact
                      mode: EDIT
                      components:
                        - uesio/io.grid:
                            uesio.styleTokens:
                              root:
                                - grid-cols-2
                                - grid-rows-3
                            items:
                              - uesio/io.field:
                                  fieldId: uesio/crm.account
                                  label: Company Name
                                  labelPosition: top
                              - uesio/io.field:
                                  fieldId: uesio/crm.department
                              - uesio/io.field:
                                  fieldId: uesio/crm.title
                              - uesio/io.field:
                                  fieldId: uesio/crm.phone_business
                              - uesio/io.field:
                                  fieldId: uesio/crm.assistant_name
                              - uesio/io.field:
                                  fieldId: uesio/crm.assistant_phone
                              - uesio/io.field:
                                  fieldId: uesio/crm.lead_source
                            columnGap: 8px
              - id: tasks
                label: Tasks
                components:
              - id: events
                label: Events
                components:
              - id: history
                label: History
                components:
            footer:
              - uesio/io.group:
                  components:
                    - uesio/io.button:
                        text: Edit Pic
                        uesio.variant: uesio/io.primary
                        signals:
                          - signal: wire/SAVE
                            wires:
                              - newcontact
                          - signal: panel/CLOSE
                            panel: newContact
                          - signal: panel/OPEN
                            panel: addPic
                        icon: add_a_photo
                    - uesio/io.button:
                        text: $Label{uesio/io.save}
                        uesio.variant: uesio/io.primary
                        signals:
                          - signal: panel/CLOSE
                            panel: newContact
                          - signal: wire/SAVE
                            wires:
                              - newcontact
                          - signal: wire/LOAD
                            wires:
                              - contacts
                        icon: save
                    - uesio/io.button:
                        text: Save & New
                        uesio.variant: uesio/io.primary
                        signals:
                          - signal: wire/SAVE
                            wires:
                              - newcontact
                          - signal: wire/EMPTY
                            wire: newcontact
                          - signal: wire/CREATE_RECORD
                            wire: newcontact
                            prepend: true
                        icon: save
                    - uesio/io.button:
                        text: $Label{uesio/io.cancel}
                        uesio.variant: uesio/io.secondary
                        signals:
                          - signal: panel/CLOSE
                            panel: newContact
                          - signal: wire/CANCEL
                            wires:
                              - newcontact
                            wire: newcontact
                          - signal: wire/EMPTY
                            wires:
                              - contacts
                            wire: newcontact
                        icon: cancel
      title: Edit Contact
      width: 80vh
      height: auto
    addPic:
      uesio.type: uesio/io.dialog
      components:
        - uesio/io.box:
            components:
              - uesio/io.deck:
                  wire: newcontact
                  components:
                    - uesio/io.text:
                        text: ${uesio/crm.firstname} ${uesio/crm.lastname}
                        element: h2
                        align: center
                    - uesio/io.box:
                        components:
                          - uesio/io.grid:
                              uesio.styleTokens:
                                root:
                                  - grid-cols-1
                                  - items-center
                              items:
                                - uesio/io.box:
                                    components:
                                      - uesio/io.field:
                                          fieldId: uesio/crm.image
                                          displayAs: PREVIEW
                                          labelPosition: none
                                        label: null
                                        labelPosition: none
                  mode: EDIT
              - uesio/io.group:
                  columnGap: 10px
                  components:
                    - uesio/io.button:
                        text: Done
                        signals:
                          - signal: panel/CLOSE
                            panel: addPic
                          - signal: panel/OPEN
                            panel: newContact
                          - signal: wire/LOAD
                            wires:
                              - contacts
                        uesio.variant: uesio/io.secondary
                        icon: check
                    - uesio/io.button:
                        text: Exit
                        signals:
                          - signal: panel/CLOSE
                            panel: addPic
                          - signal: wire/LOAD
                            wires:
                              - contacts
                        uesio.variant: uesio/io.secondary
                        icon: exit_to_app
      width: 1fr
      height: 1fr
    delete:
      uesio.type: uesio/io.dialog
      components:
        - uesio/io.deck:
            wire: newcontact
            components:
              - uesio/io.text:
                  text: Are you sure you want to delete ${uesio/crm.firstname} ${uesio/crm.lastname}?
      actions:
        - uesio/io.group:
            components:
              - uesio/io.button:
                  text: $Label{uesio/io.delete}
                  signals:
                    - signal: wire/MARK_FOR_DELETE
                      wires:
                        - newcontact
                    - signal: wire/SAVE
                      wires:
                        - newcontact
                    - signal: wire/LOAD
                      wires:
                        - contacts
                    - signal: panel/CLOSE
                      panel: delete
                  uesio.variant: uesio/io.primary
                  icon: delete
              - uesio/io.button:
                  text: $Label{uesio/io.cancel}
                  signals:
                    - signal: wire/UNMARK_FOR_DELETE
                      wires:
                        - newcontact
                    - signal: panel/CLOSE
                      panel: delete
                  uesio.variant: uesio/io.secondary
                  icon: cancel
      title: "Delete Contact?"
      width: 380px
      height: 320px
