name: leads
public: true
definition:
  components:
    - uesio/core.view:
        view: uesio/crm.topbar
    - uesio/io.box:
        uesio.variant: uesio/crm.content
        components:
          - uesio/io.titlebar:
              title: Leads
              uesio.variant: uesio/io.main
              actions:
                - uesio/io.group:
                    components:
                      - uesio/io.button:
                          signals:
                            - signal: wire/EMPTY
                              wire: new_lead
                            - signal: wire/CREATE_RECORD
                              wire: new_lead
                              prepend: true
                            - signal: wire/UPDATE_RECORD
                              wire: new_lead
                              field: uesio/crm.status
                              value: OPEN
                            - signal: panel/OPEN
                              panel: newlead
                          text: New
                          uesio.variant: uesio/io.secondary
                          icon: add
                      - uesio/io.button:
                          text: Save
                          icon: check
                          uesio.variant: uesio/io.primary
                          signals:
                            - signal: wire/SAVE
                              wires:
                                - leads
                            - signal: wire/LOAD
                              wires:
                                - recent
                          uesio.display:
                            - type: wireHasChanges
                              operator: EQUALS
                              wire: leads
                      - uesio/io.button:
                          text: Cancel
                          icon: cancel
                          uesio.variant: uesio/io.primary
                          signals:
                            - signal: wire/CANCEL
                              wires:
                                - leads
                              wire: leads
                          uesio.display:
                            - type: wireHasChanges
                              operator: EQUALS
                              wire: leads
          - uesio/io.group:
              components:
                - uesio/io.searchbox:
                    wire: leads
                    searchfields:
                      - uesio/crm.firstname
                      - uesio/crm.lastname
                      - uesio/crm.account
                      - uesio/core.owner
                - uesio/io.filter:
                    wire: leads
                    fieldId: uesio/crm.status
                    labelPosition: top
                    label: " "
          - uesio/io.grid:
              uesio.styleTokens:
                root:
                  - grid-cols-1
                  - grid-rows-1
              items:
                - uesio/io.box:
                    components:
                      - uesio/io.text:
                          text: OPEN LEADS
                          element: div
                          align: left
                          uesio.variant: uesio/io.smalltitle
                      - uesio/io.table:
                          rowactions:
                            - text: View
                              signals:
                                - path: lead/${uesio/core.id}
                                  signal: route/NAVIGATE
                            - text: Delete
                              signals:
                                - signal: wire/TOGGLE_DELETE_STATUS
                          columns:
                            - field: uesio/crm.firstname
                            - field: uesio/crm.lastname
                            - field: uesio/crm.account
                              label: Company
                              width: 220px
                            - field: uesio/crm.email
                            - field: uesio/crm.industry
                            - field: uesio/crm.status
                            - field: uesio/crm.rating
                            - field: uesio/crm.mailing_city
                            - field: uesio/core.owner
                          id: leadsTable
                          mode: EDIT
                          wire: leads
                          uesio.variant: uesio/io.default
                          pagesize: 5
                    uesio.variant: ""
              columnGap: 1px
              rowGap: 8px
          - uesio/io.box:
              components:
                - uesio/io.grid:
                    items:
                      - uesio/io.text:
                          text: RECENT
                          element: div
                          align: left
                      - uesio/io.table:
                          rowactions:
                            - text: View
                              signals:
                                - path: lead/${uesio/core.id}
                                  signal: route/NAVIGATE
                          columns:
                            - field: uesio/crm.account
                              label: Lead
                              width: 320px
                            - field: uesio/core.updatedat
                              label: Updated
                              width: 180px
                          id: leadsTable
                          mode: READ
                          wire: recent
                          uesio.variant: uesio/io.default
                          pagesize: 5
                    uesio.styleTokens:
                      root:
                        - grid-cols-1
                        - grid-rows-2
          - uesio/io.box:
              uesio.variant: ""
              components:
                - uesio/io.text:
                    text: CLOSED LEADS
                    element: div
                    uesio.variant: uesio/io.smalltitle
                - uesio/io.table:
                    rowactions:
                      - text: View
                        signals:
                          - path: lead/${uesio/core.id}
                            signal: route/NAVIGATE
                    wire: closedleads
                    pagesize: 5
                    columns:
                      - field: uesio/crm.firstname
                      - field: uesio/crm.lastname
                      - field: uesio/crm.account
                      - field: uesio/crm.converted_to_contact
                      - field: uesio/crm.converted_to_account
                      - field: uesio/crm.converted_opportunity
                      - field: uesio/crm.converted_date
                      - field: uesio/crm.status
  wires:
    leads:
      collection: uesio/crm.lead
      fields:
        uesio/crm.firstname: null
        uesio/core.id: null
        uesio/crm.lastname: null
        uesio/core.updatedat: null
        uesio/core.createdat: null
        uesio/crm.account: null
        uesio/crm.email: null
        uesio/crm.mailing_city: null
        uesio/crm.mailing_country: null
        uesio/crm.phone_business: null
        uesio/crm.status: null
        uesio/crm.rating: null
        uesio/crm.industry: null
        uesio/crm.image_url: null
        uesio/crm.contact_image: null
        uesio/core.createdby: null
        uesio/core.owner: null
      conditions:
        - operator: EQ
          field: uesio/crm.status
          valueSource: VALUE
          value: "OPEN"
    closedleads:
      type: ""
      fields:
        uesio/crm.status: null
        uesio/crm.industry: null
        uesio/crm.mailing_country: null
        uesio/crm.mailing_city: null
        uesio/crm.account: null
        uesio/crm.lastname: null
        uesio/crm.firstname: null
        uesio/core.updatedat: null
        uesio/core.createdat: null
        uesio/core.id: null
        uesio/crm.converted_date: null
        uesio/crm.converted_opportunity: null
        uesio/crm.converted_to_account: null
        uesio/crm.converted_to_contact: null
      collection: uesio/crm.lead
      conditions:
        - active: true
          field: uesio/crm.status
          operator: NOT_EQ
          valueSource: VALUE
          value: OPEN
    recent:
      type: ""
      fields:
        uesio/crm.account: null
        uesio/crm.lastname: null
        uesio/crm.firstname: null
        uesio/core.updatedat: null
      collection: uesio/crm.lead
      order:
        - desc: true
          field: uesio/core.updatedat
      batchsize: 5
      conditions: []
    accounts:
      collection: uesio/crm.account
      fields:
        uesio/crm.name: null
        uesio/crm.description: null
    contacts:
      collection: uesio/crm.contact
      fields:
        uesio/crm.firstname: null
        uesio/crm.lastname: null
        uesio/crm.account: null
        uesio/crm.email: null
    new_lead:
      batchsize: 1
      collection: uesio/crm.lead
      fields:
        uesio/crm.account: {}
        uesio/crm.firstname: {}
        uesio/crm.lastname: {}
        uesio/crm.email: {}
        uesio/crm.status: {}
        uesio/crm.title: {}
        uesio/crm.website: {}
        uesio/crm.rating: {}
        uesio/crm.phone_mobile: {}
        uesio/crm.phone_business: {}
        uesio/crm.no_employees: {}
        uesio/crm.mailing_city: {}
        uesio/crm.mailing_country: {}
        uesio/crm.industry: {}
        uesio/crm.description: {}
        uesio/crm.annual_revenue: {}
  panels:
    newlead:
      uesio.type: uesio/io.dialog
      components:
        - uesio/io.grid:
            uesio.styleTokens:
              root:
                - grid-cols-3
                - grid-rows-1
            items:
              - uesio/io.list:
                  mode: EDIT
                  wire: new_lead
                  components:
                    - uesio/io.field:
                        fieldId: uesio/crm.account
                        displayAs: TEXT
                        label: Company
                    - uesio/io.field:
                        fieldId: uesio/crm.title
                    - uesio/io.field:
                        fieldId: uesio/crm.firstname
                    - uesio/io.field:
                        fieldId: uesio/crm.lastname
                    - uesio/io.field:
                        fieldId: uesio/crm.email
                    - uesio/io.field:
                        fieldId: uesio/crm.annual_revenue
                    - uesio/io.field:
                        fieldId: uesio/crm.industry
                    - uesio/io.field:
                        fieldId: uesio/crm.mailing_street
                    - uesio/io.field:
                        fieldId: uesio/crm.mailing_city
                    - uesio/io.field:
                        fieldId: uesio/crm.mailing_country
                    - uesio/io.field:
                        fieldId: uesio/crm.description
            columnGap: 12px
            rowGap: 12px
      width: 100%
      height: 60%
      title: New Lead
      actions:
        - uesio/io.button:
            text: Save
            icon: save
            uesio.variant: uesio/io.secondary
            signals:
              - signal: wire/SAVE
                wires:
                  - new_lead
              - signal: wire/LOAD
                wires:
                  - leads
              - signal: panel/CLOSE
                panel: newlead
        - uesio/io.button:
            text: Cancel
            icon: cancel
            uesio.variant: uesio/io.secondary
            signals:
              - signal: wire/CANCEL
                wire: new_lead
              - signal: panel/CLOSE
                panel: newlead
