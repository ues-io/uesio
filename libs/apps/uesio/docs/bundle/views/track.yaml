name: track
definition:
  components:
    - uesio/io.titlebar:
        uesio.variant: uesio/io.main
        title: $Param{track}
        subtitle: Is there a doc in the room?!

    - uesio/io.grid:
        uesio.variant: uesio/docs.mainlayout
        items:
          - uesio/io.griditem:
              uesio.variant: uesio/docs.localnav
              components:
                - uesio/io.text:
                    text: $Param{track}
                    element: h3
                - uesio/core.view:
                    view: uesio/docs.doclist
                    params:
                      slug: nope
                    uesio.context:
                      wire: articles
          - uesio/io.griditem:
              components:
                - uesio/io.list:
                    wire: track
                    components:
                      - uesio/io.text:
                          text: ${uesio/docs.name}
                          element: h1
                      - uesio/io.text:
                          text: "prerequisites: ${uesio/docs.prerequisites}"
                          element: p
                      - uesio/io.field:
                          fieldId: uesio/docs.content
                          displayAs: MARKDOWN
                          id: mdcontent
                          labelPosition: none
                      - uesio/io.button:
                          text: Start learning
                          uesio.variant: uesio/io.primary
                          signal:
                            - signal: "route/NAVIGATE"
                              path: "docs/${uesio/docs.name}/${uesio/docs.doc->uesio/docs.name}"

  wires:
    track:
      collection: uesio/docs.track
      fields:
        uesio/core.id:
        uesio/docs.name:
        uesio/docs.description:
        uesio/docs.content:
        uesio/docs.prerequisites:
        uesio/docs.doc:
          fields:
            uesio/core.id:
            uesio/cms.name:
            uesio/cms.slug:
      conditions:
        - field: uesio/docs.name
          param: track
          valueSource: PARAM

    articles:
      collection: uesio/cms.article
      conditions:
        - field: uesio/docs.track
          lookupWire: track
          lookupField: uesio/core.id
          valueSource: LOOKUP
      order:
        - field: uesio/docs.order
      fields:
        uesio/core.createdat:
        uesio/core.id:
        uesio/docs.track:
          fields:
            uesio/core.id:
            uesio/docs.name:
        uesio/cms.content:
        uesio/cms.name:
        uesio/cms.slug:
        uesio/docs.order:

    article:
      collection: uesio/cms.article
      fields:
        uesio/core.createdat:
        uesio/core.id:
        uesio/docs.track:
          fields:
            uesio/core.id:
            uesio/docs.name:
        uesio/cms.content:
        uesio/cms.name:
        uesio/docs.order:
      order:
        - field: uesio/docs.order
      limit: 2
      conditions:
        - field: uesio/core.id
          lookupWire: track
          lookupField: uesio/docs.doc
          valueSource: LOOKUP
