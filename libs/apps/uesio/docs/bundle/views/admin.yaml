name: admin
definition:
  components:
    - uesio/io.titlebar:
        uesio.variant: uesio/io.main
        title: Admin panel
        subtitle: Is there a doc in the room?!
        actions:
          - uesio/io.group:
              components:
                - uesio/io.button:
                    text: Create a New Collection
                    uesio.variant: uesio/io.secondary

    # variant: Admin section
    - uesio/io.box:
        uesio.styles:
          root:
            backgroundColor: "#eee"
            padding: 40px
        components:
          - uesio/io.titlebar:
              uesio.variant: uesio/io.main
              title: Tracks
              actions:
                - uesio/io.group:
                    components:
                      - uesio/io.button:
                          text: Add a track
                          uesio.variant: uesio/io.secondary
                          signals:
                            - signal: wire/CREATE_RECORD
                              wire: newtrack

          - uesio/io.box:
              uesio.styles:
                root:
                  display: flex
                  gap: 15px
              components:
                # Tracks
                - uesio/io.list:
                    wire: tracks
                    id: trackList
                    components:
                      - uesio/io.box:
                          uesio.styles:
                            root:
                              border: "1px solid #000"
                              flex: 50%
                              padding: 15px
                          components:
                            - uesio/io.text:
                                text: ${uesio/docs.name}
                # New track
                - uesio/io.list:
                    wire: newtrack
                    id: newTrackList
                    mode: EDIT
                    components:
                      - uesio/io.box:
                          uesio.styles:
                            root:
                              border: "1px solid #000"
                              flex: 50%
                              padding: 15px
                          components:
                            - uesio/io.field:
                                fieldId: uesio/docs.name
                            - uesio/io.group:
                                components:
                                  - uesio/io.button:
                                      uesio.variant: uesio/io.secondary
                                      text: Cancel
                                      signal:
                                        - signal: wire/CANCEL
                                          wires: newtrack
                                  - uesio/io.button:
                                      uesio.variant: uesio/io.primary
                                      text: Save
                                      signals:
                                        - signal: wire/SAVE
                                          wires:
                                            - newtrack
                                        - signal: wire/EMPTY
                                          wire: newtrack
                                        - signal: wire/LOAD
                                          wires:
                                            - tracks

    # variant: Admin section
    - uesio/io.box:
        uesio.styles:
          root:
            backgroundColor: "#eee"
            padding: 40px
        components:
          - uesio/io.titlebar:
              uesio.variant: uesio/io.main
              title: Docs
              actions:
                - uesio/io.group:
                    components:
                      - uesio/io.button:
                          text: Add a doc
                          uesio.variant: uesio/io.secondary
                          signals:
                            - signal: wire/CREATE_RECORD
                              wire: newarticle
          - uesio/io.searchbox:
              wire: articles
          - uesio/io.box:
              uesio.styles:
                root:
                  display: flex
                  gap: 15px
                  flexFlow: column
              components:
                # New article
                - uesio/io.list:
                    wire: newarticle
                    id: newArticleList
                    mode: EDIT
                    components:
                      - uesio/io.box:
                          uesio.styles:
                            root:
                              border: "1px solid #000"
                              flex: 50%
                              padding: 15px
                          components:
                            - uesio/io.field:
                                fieldId: uesio/cms.name
                            - uesio/io.field:
                                fieldId: uesio/docs.track
                                reference:
                                  template: ${uesio/docs.name}
                                  searchFields:
                                    - uesio/docs.name
                                  returnFields:
                                    - uesio/docs.name
                            - uesio/io.group:
                                components:
                                  - uesio/io.button:
                                      uesio.variant: uesio/io.secondary
                                      text: Cancel
                                      signals:
                                        - signal: wire/CANCEL
                                          wire: newarticle
                                  - uesio/io.button:
                                      uesio.variant: uesio/io.primary
                                      text: Save
                                      signals:
                                        - signal: wire/SAVE
                                          wires:
                                            - newarticle
                                        - signal: wire/EMPTY
                                          wire: newarticle
                                        - signal: wire/LOAD
                                          wires:
                                            - articles

                # Articles list
                - uesio/io.list:
                    wire: articles
                    id: articleList
                    components:
                      - uesio/io.box:
                          uesio.styles:
                            root:
                              border: "1px solid #000"
                              flex: 1
                              padding: 15px
                              display: flex
                          components:
                            - uesio/io.button:
                                icon: visibility
                                signals:
                                  - signal: "route/NAVIGATE"
                                    path: "docs/${uesio/docs.track->uesio/docs.name}/${uesio/cms.slug}"
                                uesio.styles:
                                  root:
                                    background: $Theme{color.primary}
                                    border-radius: 1.5em
                                    width: 3em
                                    margin-right: 1em
                            - uesio/io.button:
                                icon: edit
                                signals:
                                  - signal: "route/NAVIGATE"
                                    path: "admin/${uesio/core.id}"
                                uesio.styles:
                                  root:
                                    background: $Theme{color.primary}
                                    border-radius: 1.5em
                                    width: 3em
                                    margin-right: 1em
                            - uesio/io.box:
                                components:
                                  - uesio/io.text:
                                      text: ${uesio/cms.name}
                                      element: p
                                      uesio.styles:
                                        root:
                                          margin: 0 0 0.25em 0
                                  - uesio/io.text:
                                      text: ${uesio/docs.track->uesio/docs.name}
                                      element: p
                                      uesio.styles:
                                        root:
                                          margin: 0
                                          fontSize: 0.8em

    # - uesio/io.grid:
    #     uesio.variant: uesio/docs.mainlayout
    #     items:
    #       - uesio/io.griditem:
    #           uesio.variant: uesio/docs.localnav
    #           components:
    #             - uesio/io.text:
    #                 text: left
    #       - uesio/io.griditem:
    #           uesio.styles:
    #             root:
    #               backgroundColor: #eee
    #           components:
    #             - uesio/io.text:
    #                 text: main

  wires:
    # Articles
    newarticle:
      collection: uesio/cms.article
      init:
        query: false
      fields:
        uesio/core.createdat:
        uesio/core.id:
        uesio/docs.track:
          fields:
            uesio/core.id:
            uesio/docs.name:
        uesio/cms.content:
        uesio/cms.name:

    articles:
      collection: uesio/cms.article
      order:
        - field: uesio/core.updatedat
          desc: true
      fields:
        uesio/core.updatedat:
        uesio/core.id:
        uesio/docs.order:
        uesio/docs.track:
          fields:
            uesio/core.id:
            uesio/docs.name:
        uesio/cms.content:
        uesio/cms.name:
        uesio/cms.slug:

    # Tracks
    tracks:
      collection: uesio/docs.track
      fields:
        uesio/core.id:
        uesio/docs.name:
    newtrack:
      collection: uesio/docs.track
      init:
        query: false
      fields:
        uesio/core.id:
        uesio/docs.name:
